library(hamcrest)

 
 
expected <- c(101.119971428571+0i, -29.0928136430285+4.7733132342952i, -5.20569669800416+3.22944995187721i, 
1.0940967719487+1.3634735733143i, -1.97171071092544+3.37279263620709i, 
0.88971792665468-1.93136796113502i, -6.12356673328185+4.86762410247205i, 
6.12723839832055-1.5399967231575i, -2.96214541857402+3.83735976064713i, 
-3.86372862227655+0.22071580472158i, -1.98948162465517-8.01131587212179i, 
-0.90709748013214+6.04771076119084i, -9.96827469726697-3.36903966620577i, 
2.89973656961615-0.64834692594678i, 10.5831624331481-2.3897986984906i, 
6.02655972199865-0.37704844440113i, -10.916223351644+6.3427574475901i, 
5.97120686619439-3.66981137747227i, -4.85700414733527-1.02687452470301i, 
3.88838851304527-0.38661975474375i, 1.46777919158483+4.50404715518398i, 
1.62820769910605-0.7109946158639i, -1.98705864790229+1.34231255807552i, 
-3.88127911370275+1.16797618047052i, -2.39001922127485-0.49072364719731i, 
1.66708900071464-0.07571603601022i, -3.4930552208424+2.9326583272679i, 
2.38893775643741-6.25126289764784i, 1.7114131553823+0.90041043710835i, 
1.32345360474248-0.14046043578922i, -1.44310056806243-2.11166713039781i, 
-0.928273413102411-0.396434184365103i, 1.32062338215307+1.3628677219995i, 
2.66318002938641-1.68959893020436i, -0.15375037129066+1.57030697195658i, 
-1.56423296107487+2.09456952579672i, -0.20711639637513-1.84468937580927i, 
-0.67415588711064-0.776108229314138i, 0.21304927326371+1.55478790620396i, 
-0.098254689139028-0.709196509479093i, -0.223417746109487-0.514604025683933i, 
-0.35294569617071+1.25146982469421i, 0.424011637638241-0.916995950004364i, 
-0.521702737165194-0.853288710803374i, 0.535630139857338-0.394745758407708i, 
-0.175828668685458+0.243876958639808i, 0.247495449138541-0.539127580780552i, 
-0.208059994643438-0.01234792751677i, 0.0081624404039213+0.0428682349474749i, 
0.187901276151706+0.205010771640762i, -0.318321663737767+0.261365620463387i, 
-0.152081248039177+0.142123308569795i, -0.407087366878616-0.087274752613443i, 
-0.15296523528396-0.423052829369986i, 0.186523240513986-0.348599223069002i, 
0.50385539226135-0.062092793593754i, 0.17495508401943-0.035126205803208i, 
0.364826651202626+0.523153315493584i, -0.17362871039416+0.2333130795541i, 
-0.630294588313248-0.235203592177853i, 0.231918660275831+0.108788023594288i, 
0.20990093264647-1.27829584757825i, -0.234289240223128+0.095525823309912i, 
0.276743713455582+0.444975153393373i, -0.783793621215291-0.481201832511382i, 
0.289191810892116-0.675115542188644i, 0.431747782391582+0.3669301723517i, 
0.321715880588642+0.330452900595055i, -0.008378108717043-0.560125139753242i, 
-0.681724009371312+0.57143775910408i, 0.365812374732416+0.592820271756833i, 
-0.185715129341861-0.233573696118943i, 0.385579417512699+0.12054948769121i, 
-0.334234862628663+0.051498300939802i, -0.334624273023607-0.74287836879197i, 
0.20188449137743-1.16733253072322i, 1.15980813511495-0.62103284165711i, 
-1.31358144493962+0.61193646973014i, 0.159856936537169+0.06982623655374i, 
-0.245682470929035+0.272229466499051i, 0.761089167186817-0.481234298849565i, 
0.219064344202773-0.473083220602615i, -0.776414693287445+0.983532577923787i, 
0.026148497676744-0.483033041880107i, -0.102394986360345+0.107992114849448i, 
0.341191766052159-0.294601656014172i, -0.294490038329213+0.137212617013003i, 
-0.14149401266521+0.760723200756805i, 0.50618505638451-0.477602978003357i, 
0.495232583607719-0.619339507633893i, -0.836574071404834+0.239838104114234i, 
0.29324900008419-0.26112460337175i, -0.344498076002051+0.177712013043978i, 
-0.166734119052728-0.013604603760193i, 0.134508520757813-0.367283301238426i, 
0.414262049221024+0.130356568582229i, 0.04090738448952+0.292986942614939i, 
0.133373601849501-0.203361896660712i, -0.16564459821796+0.126198322150819i, 
-0.248780363331188-0.005496422101876i, -0.0171549110558606-0.0215826517955834i, 
-0.163477202543206-0.196985268829725i, 0.365427900036606-0.148374737055009i, 
0.233124577765637+0.091507922929411i, 0.120460157951207+0.177193532952287i, 
0.0580546610724686+0.0557388548564469i, 0.250708001952548+0.128986193124126i, 
-0.016538100557368+0.125433503140384i, -0.256629031038415-0.001077092499374i, 
-0.256952599277096-0.303700597968947i, 0.248417411749364-0.465468690005031i, 
0.043139740033143+0.103705491065619i, 0.0920478686172517+0.0722448085978611i, 
-0.002166938706059-0.0237793274786184i, -0.007375027031601-0.21140638787198i, 
0.173862685169179-0.199515581685825i, -0.3264972316452-0.001536239410095i, 
0.024286652215121+0.336882574931174i, 0.0113168450974185+0.0454630660346881i, 
0.08016352443231+0.20914327378845i, 0.051352738981332+0.235170008815197i, 
-0.50190511664694-1.10123103142822i, 0.07402712453049+0.519383850954228i, 
0.542711069885971+0.129387921368617i, -0.228643946103848-0.284860115602772i, 
-0.077943558326014+0.143036725326054i, 0.06315754359417-0.475874811801814i, 
-0.26033038194796-0.245503170332421i, 0.515359668066568+0.709071561467882i, 
-0.33365673542794-0.597968107585273i, 0.158939397161052+0.22310850073496i, 
-0.530528455179246-0.349573471181739i, -0.139492092615565+0.808512977917533i, 
0.805832570287968-0.303691379916585i, -0.036949820485999-0.102623610507412i, 
0.128376121793779+0.038915285632238i, -0.454786061734476-0.303700560388166i, 
-0.035514307852598+0.589121796947953i, 0.163074835807349-0.316025415927559i, 
0.0644185006685531+0.0679271386515704i, 0.152623103103-0.114594535104623i, 
-0.064687885763079-0.574259134319692i, -0.005576352725757+0.111534546779893i, 
0.142196559182263-0.041311100812739i, 0.146456869692113+0.145411704677228i, 
0.034656882413895-0.300520665037252i, -0.161361962768163+0.363380443448517i, 
0.285632411594171-0.410425501054323i, 0.0212982550201122+0.0924817250003845i, 
0.277591557123514+0.084106961013503i, -0.196155091452199-0.147217037155562i, 
0.0627627889317723+0.0126262612608449i, 0.057476148817953-0.229777525238333i, 
0.257265027977863+0.139543256130131i, -0.086421509930521-0.158580468096672i, 
-0.011591177119464+0.0637479305728074i, 0.024325517504541-0.389856889062039i, 
-0.022881701317122+0.0802401231445108i, 0.104647144348854-0.249673530465466i, 
-0.0575470455862802+0.0157069092464935i, 0.377319751330373-0.132610807550035i, 
-0.054445020599987+0.255974575355625i, 0.293791388083216+0.061621023566327i, 
-0.364952483621301+0.137715006295555i, 0.245339478630101-0.183476047117887i, 
-0.150951653051984-0.071002560139322i, 0.166211061336581-0.027278288907184i, 
-0.189590955913188-0.149548572381756i, 0.179967844362925+0.122580906312621i, 
-0.052473498615316-0.200176436250541i, 0.184921259258643+0.260472552007184i, 
-0.284832165188056-0.231835425724245i, 0.753137988507299+0.201099813642366i, 
-0.216072324049588-0.388398546873495i, 0.096741457031309+0.207674734371303i, 
0.189735474475244-0.185844613661841i, -0.040936506548897+0.59041716289338i, 
-0.153084211159132-0.160312041776376i, 0.125074473843642+0.069497784893694i, 
0.136853440285619+0.159814872697243i, 0.162885512416335-0.226102015592711i, 
0.511474112250666-0.359683887609973i, -0.406108646980324+0.506386596951045i, 
-0.406108646980324-0.506386596951046i, 0.511474112250662+0.359683887609973i, 
0.162885512416335+0.226102015592711i, 0.136853440285633-0.159814872697246i, 
0.12507447384364-0.069497784893697i, -0.153084211159132+0.160312041776372i, 
-0.040936506548905-0.590417162893384i, 0.189735474475244+0.185844613661841i, 
0.096741457031327-0.207674734371308i, -0.216072324049588+0.388398546873494i, 
0.753137988507297-0.201099813642366i, -0.284832165188071+0.231835425724241i, 
0.184921259258643-0.260472552007184i, -0.052473498615302+0.200176436250537i, 
0.179967844362928-0.122580906312621i, -0.189590955913191+0.149548572381753i, 
0.166211061336567+0.027278288907183i, -0.150951653051984+0.071002560139322i, 
0.245339478630113+0.183476047117884i, -0.364952483621297-0.137715006295557i, 
0.293791388083213-0.06162102356633i, -0.0544450206-0.255974575355629i, 
0.377319751330373+0.132610807550035i, -0.0575470455862683-0.0157069092464959i, 
0.104647144348857+0.249673530465463i, -0.022881701317125-0.080240123144514i, 
0.024325517504526+0.389856889062035i, -0.011591177119464-0.0637479305728074i, 
-0.086421509930508+0.158580468096667i, 0.257265027977865-0.139543256130133i, 
0.05747614881795+0.229777525238332i, 0.0627627889317576-0.0126262612608486i, 
-0.196155091452199+0.147217037155562i, 0.277591557123526-0.084106961013507i, 
0.021298255020115-0.0924817250003873i, 0.285632411594167+0.410425501054322i, 
-0.161361962768177-0.363380443448523i, 0.034656882413895+0.300520665037252i, 
0.146456869692126-0.145411704677232i, 0.142196559182267+0.041311100812738i, 
-0.00557635272576-0.111534546779896i, -0.064687885763095+0.574259134319689i, 
0.152623103103+0.114594535104623i, 0.0644185006685669-0.0679271386515741i, 
0.163074835807351+0.316025415927556i, -0.035514307852601-0.589121796947955i, 
-0.45478606173449+0.303700560388162i, 0.128376121793779-0.038915285632238i, 
-0.036949820485985+0.10262361050741i, 0.80583257028797+0.303691379916582i, 
-0.139492092615567-0.808512977917535i, -0.530528455179259+0.349573471181735i, 
0.158939397161052-0.22310850073496i, -0.333656735427926+0.597968107585268i, 
0.515359668066572-0.709071561467884i, -0.260330381947964+0.245503170332418i, 
0.063157543594157+0.475874811801812i, -0.077943558326014-0.143036725326054i, 
-0.228643946103833+0.284860115602768i, 0.542711069885974-0.12938792136862i, 
0.074027124530487-0.519383850954231i, -0.50190511664695+1.10123103142821i, 
0.051352738981332-0.235170008815197i, 0.080163524432325-0.209143273788454i, 
0.0113168450974219-0.04546306603469i, 0.024286652215118-0.336882574931177i, 
-0.326497231645213+0.001536239410091i, 0.173862685169179+0.199515581685825i, 
-0.007375027031587+0.211406387871976i, -0.0021669387060564+0.0237793274786159i, 
0.0920478686172482-0.0722448085978637i, 0.04313974003313-0.103705491065623i, 
0.248417411749364+0.465468690005031i, -0.256952599277084+0.303700597968942i, 
-0.256629031038412+0.001077092499371i, -0.01653810055737-0.125433503140386i, 
0.250708001952535-0.128986193124129i, 0.0580546610724686-0.0557388548564469i, 
0.120460157951219-0.177193532952291i, 0.23312457776564-0.091507922929413i, 
0.365427900036603+0.148374737055008i, -0.163477202543219+0.196985268829721i, 
-0.0171549110558606+0.0215826517955834i, -0.248780363331175+0.005496422101873i, 
-0.165644598217958-0.126198322150822i, 0.133373601849498+0.20336189666071i, 
0.040907384489506-0.292986942614943i, 0.414262049221024-0.130356568582229i, 
0.134508520757824+0.367283301238422i, -0.166734119052725+0.013604603760192i, 
-0.344498076002054-0.177712013043981i, 0.293249000084177+0.261124603371748i, 
-0.836574071404834-0.239838104114234i, 0.495232583607732+0.61933950763389i, 
0.506185056384512+0.477602978003356i, -0.141494012665213-0.760723200756807i, 
-0.294490038329227-0.137212617013007i, 0.341191766052159+0.294601656014172i, 
-0.102394986360332-0.107992114849451i, 0.026148497676748+0.483033041880104i, 
-0.776414693287449-0.98353257792379i, 0.21906434420276+0.473083220602612i, 
0.761089167186817+0.481234298849565i, -0.245682470929022-0.272229466499054i, 
0.159856936537172-0.069826236553742i, -1.31358144493962-0.61193646973014i, 
1.15980813511494+0.62103284165711i, 0.20188449137743+1.16733253072322i, 
-0.334624273023597+0.742878368791966i, -0.334234862628659-0.051498300939804i, 
0.385579417512696-0.120549487691211i, -0.185715129341876+0.233573696118938i, 
0.365812374732416-0.592820271756833i, -0.6817240093713-0.571437759104083i, 
-0.00837810871704+0.56012513975324i, 0.321715880588639-0.330452900595057i, 
0.431747782391568-0.366930172351706i, 0.289191810892116+0.675115542188644i, 
-0.783793621215278+0.481201832511377i, 0.276743713455585-0.444975153393375i, 
-0.234289240223131-0.095525823309914i, 0.20990093264645+1.27829584757825i, 
0.231918660275831-0.108788023594288i, -0.630294588313235+0.235203592177849i, 
-0.173628710394158-0.233313079554102i, 0.364826651202624-0.523153315493586i, 
0.174955084019417+0.035126205803204i, 0.50385539226135+0.062092793593754i, 
0.186523240513999+0.348599223068998i, -0.152965235283956+0.423052829369984i, 
-0.407087366878619+0.087274752613441i, -0.152081248039191-0.142123308569798i, 
-0.318321663737767-0.261365620463387i, 0.187901276151721-0.205010771640765i, 
0.0081624404039237-0.0428682349474774i, -0.208059994643441+0.012347927516767i, 
0.247495449138528+0.539127580780549i, -0.175828668685458-0.243876958639808i, 
0.53563013985735+0.394745758407704i, -0.521702737165191+0.85328871080337i, 
0.424011637638239+0.916995950004363i, -0.35294569617073-1.25146982469422i, 
-0.223417746109487+0.514604025683933i, -0.098254689139015+0.709196509479088i, 
0.21304927326372-1.55478790620396i, -0.674155887110645+0.776108229314133i, 
-0.20711639637515+1.84468937580927i, -1.56423296107487-2.09456952579672i, 
-0.15375037129064-1.57030697195659i, 2.66318002938641+1.68959893020437i, 
1.32062338215307-1.3628677219995i, -0.928273413102425+0.396434184365095i, 
-1.44310056806243+2.11166713039781i, 1.32345360474249+0.14046043578922i, 
1.7114131553823-0.90041043710834i, 2.3889377564374+6.25126289764784i, 
-3.49305522084241-2.93265832726791i, 1.66708900071464+0.07571603601022i, 
-2.39001922127483+0.4907236471973i, -3.88127911370275-1.16797618047053i, 
-1.98705864790229-1.34231255807553i, 1.62820769910604+0.7109946158639i, 
1.46777919158483-4.50404715518398i, 3.88838851304529+0.38661975474375i, 
-4.85700414733527+1.026874524703i, 5.97120686619438+3.66981137747227i, 
-10.916223351644-6.3427574475901i, 6.02655972199865+0.37704844440113i, 
10.5831624331481+2.3897986984906i, 2.89973656961615+0.64834692594678i, 
-9.96827469726698+3.36903966620575i, -0.90709748013214-6.04771076119083i, 
-1.98948162465517+8.01131587212179i, -3.86372862227654-0.22071580472158i, 
-2.962145418574-3.83735976064714i, 6.12723839832054+1.53999672315751i, 
-6.12356673328187-4.86762410247206i, 0.88971792665468+1.93136796113502i, 
-1.97171071092544-3.37279263620709i, 1.0940967719487-1.3634735733143i, 
-5.20569669800416-3.22944995187722i, -29.0928136430286-4.7733132342952i
) 


assertThat(stats:::fft(z=c(0.0567428571428571, 0.05675, 0.0567571428571429, 0.0453785714285714, 
0.034, 0.03375, 0.0335, 0.0344, 0.0325428571428571, 0.0234, 0.0589571428571429, 
0.0634714285714286, 0.0679857142857143, 0.0725, 0.0770142857142857, 
0.0768857142857143, 0.0756714285714286, 0.0750142857142857, 0.0743571428571429, 
0.0754571428571429, 0.0907571428571429, 0.0993857142857143, 0.0768, 
0.0718142857142857, 0.120528571428571, 0.137285714285714, 0.137671428571429, 
0.126457142857143, 0.0835714285714286, 0.0813285714285714, 0.0812428571428572, 
0.0563142857142857, 0.0313857142857143, 0.0259714285714286, 0.0355047619047619, 
0.0450380952380952, 0.0545714285714286, 0.0554857142857143, 0.0685285714285714, 
0.0815714285714286, 0.0961857142857143, 0.135442857142857, 0.135628571428571, 
0.125614285714286, 0.120528571428571, 0.159442857142857, 0.141542857142857, 
0.135371428571429, 0.113114285714286, 0.2119, 0.2543, 0.2721, 
0.2843, 0.309114285714286, 0.328357142857143, 0.358528571428571, 
0.261028571428571, 0.219871428571429, 0.178314285714286, 0.1248, 
0.0888285714285714, 0.0659142857142857, 0.0279857142857143, 0.0304, 
0.0277285714285714, 0.0773428571428571, 0.0864285714285714, 0.0847428571428571, 
0.136228571428571, 0.132971428571429, 0.133942857142857, 0.1873, 
0.144385714285714, 0.1912, 0.251057142857143, 0.205214285714286, 
0.243185714285714, 0.301528571428571, 0.300071428571429, 0.349371428571429, 
0.297385714285714, 0.2696, 0.3241, 0.342142857142857, 0.2807, 
0.284757142857143, 0.306871428571429, 0.3648, 0.337185714285714, 
0.277828571428571, 0.241528571428571, 0.278928571428571, 0.240914285714286, 
0.2003, 0.148314285714286, 0.153442857142857, 0.188257142857143, 
0.201785714285714, 0.226228571428571, 0.280257142857143, 0.319642857142857, 
0.385385714285714, 0.453928571428571, 0.498014285714286, 0.545, 
0.482657142857143, 0.445242857142857, 0.451314285714286, 0.438914285714286, 
0.447471428571429, 0.456357142857143, 0.409771428571429, 0.415628571428571, 
0.397185714285714, 0.321957142857143, 0.259857142857143, 0.172942857142857, 
0.0814571428571429, 0.0517142857142857, 0.142371428571429, 0.221585714285714, 
0.313671428571429, 0.366542857142857, 0.374028571428571, 0.4551, 
0.480457142857143, 0.398328571428571, 0.417014285714286, 0.398957142857143, 
0.361157142857143, 0.380271428571429, 0.394757142857143, 0.425614285714286, 
0.421671428571429, 0.405528571428571, 0.330328571428571, 0.327171428571429, 
0.300471428571429, 0.205985714285714, 0.183457142857143, 0.263042857142857, 
0.184628571428571, 0.180471428571429, 0.192628571428571, 0.207257142857143, 
0.317128571428571, 0.395571428571429, 0.3345, 0.433728571428571, 
0.54, 0.571785714285714, 0.6666, 0.618328571428571, 0.575628571428571, 
0.629414285714286, 0.571185714285714, 0.555257142857143, 0.5878, 
0.498114285714286, 0.5401, 0.490714285714286, 0.447942857142857, 
0.504414285714286, 0.497285714285714, 0.5038, 0.498685714285714, 
0.415685714285714, 0.496428571428571, 0.469271428571429, 0.462514285714286, 
0.384785714285714, 0.402385714285714, 0.454771428571429, 0.479285714285714, 
0.5038, 0.399142857142857, 0.499014285714286, 0.394314285714286, 
0.385557142857143, 0.278242857142857, 0.227214285714286, 0.157642857142857, 
0.158242857142857, 0.0581428571428571, 0.0704571428571429, 0.0827714285714286, 
0.109785714285714, 0.196442857142857, 0.285214285714286, 0.367928571428571, 
0.459828571428571, 0.550385714285714, 0.6189, 0.653514285714286, 
0.5878, 0.495142857142857, 0.490985714285714, 0.4789, 0.392285714285714, 
0.382171428571429, 0.344514285714286, 0.314771428571429, 0.315, 
0.270442857142857, 0.243714285714286, 0.230071428571429, 0.229728571428571, 
0.253214285714286, 0.258385714285714, 0.259042857142857, 0.306085714285714, 
0.3177, 0.4137, 0.425171428571429, 0.472471428571429, 0.547857142857143, 
0.6247, 0.619785714285714, 0.636028571428571, 0.619828571428571, 
0.604142857142857, 0.5965, 0.530314285714286, 0.452085714285714, 
0.450928571428571, 0.449842857142857, 0.409242857142857, 0.3575, 
0.366185714285714, 0.431, 0.515985714285714, 0.485542857142857, 
0.487557142857143, 0.526371428571429, 0.556314285714286, 0.467885714285714, 
0.471485714285714, 0.380228571428571, 0.334785714285714, 0.247285714285714, 
0.1715, 0.130742857142857, 0.202757142857143, 0.172314285714286, 
0.257028571428571, 0.278457142857143, 0.318657142857143, 0.3127, 
0.358214285714286, 0.305871428571429, 0.2544, 0.167528571428571, 
0.191871428571429, 0.238885714285714, 0.323928571428571, 0.348528571428571, 
0.4095, 0.499285714285714, 0.584442857142857, 0.6147, 0.611085714285714, 
0.605542857142857, 0.600214285714286, 0.602142857142857, 0.607214285714286, 
0.572985714285714, 0.496728571428571, 0.411657142857143, 0.3334, 
0.330171428571429, 0.273928571428571, 0.180928571428571, 0.1977, 
0.200628571428571, 0.205414285714286, 0.206657142857143, 0.2079, 
0.1348, 0.142671428571429, 0.1421, 0.0806285714285714, 0.0981285714285714, 
0.177385714285714, 0.2648, 0.308214285714286, 0.3306, 0.417442857142857, 
0.501942857142857, 0.566885714285714, 0.484128571428571, 0.407385714285714, 
0.357028571428571, 0.343142857142857, 0.3125, 0.221928571428571, 
0.138557142857143, 0.1852, 0.172328571428571, 0.171707142857143, 
0.171085714285714, 0.121028571428571, 0.0637285714285714, 0.0641857142857143, 
0.0626857142857143, 0.0944, 0.175357142857143, 0.255414285714286, 
0.290971428571429, 0.374885714285714, 0.373985714285714, 0.409842857142857, 
0.4457, 0.443714285714286, 0.373028571428571, 0.300528571428571, 
0.278985714285714, 0.2507, 0.222414285714286, 0.194128571428571, 
0.191628571428571, 0.119128571428571, 0.0933142857142857, 0.0892428571428572, 
0.0881142857142857, 0.0854571428571429, 0.100685714285714, 0.167057142857143, 
0.1681, 0.1154, 0.119614285714286, 0.128628571428571, 0.140185714285714, 
0.134085714285714, 0.127985714285714, 0.0610714285714286, 0.0587714285714286, 
0.0999714285714286, 0.174085714285714, 0.208242857142857, 0.2611, 
0.322428571428571, 0.348757142857143, 0.395014285714286, 0.357671428571429, 
0.304271428571429, 0.253228571428571, 0.21545, 0.177671428571429, 
0.146542857142857, 0.115414285714286, 0.113169841269841, 0.110925396825397, 
0.108680952380952, 0.106436507936508, 0.104192063492064, 0.101947619047619, 
0.0997031746031746, 0.0974587301587302, 0.0952142857142857, 0.0777428571428571, 
0.0773071428571429, 0.0768714285714286, 0.0444428571428571, 0.0459857142857143, 
0))
,  equalTo( expected ) ) 
 

