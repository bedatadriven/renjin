library(hamcrest)

 
 
expected <- c(143.779148689195+0i, 8.85960049519153+0i, 3.82533086831046+0i, 
3.01541673858188-0i, 2.13712917024748+0i, 1.86686853541764-0i, 
1.50430859676396-0i, 1.36808986084188-0i, 1.16942031675447+0i, 
1.08683693974652-0i, 0.961045067362698-0i, 9.05415801247111e-01-8e-16i, 
0.818430470154111+0i, 0.778314654233925-0i, 0.714480231619985-0i, 
0.684138707464059-0i, 0.635243909995603-0i, 0.611473061802517-0i, 
0.57279108904066-0i, 0.553658128381716-0i, 0.52227292565137-0i, 
0.506540660948934-0i, 0.480554151835486-0i, 0.4673928324797-0i, 
0.445515520197509-0i, 0.434347257883854-0i, 0.415671913112042-0i, 
0.406081493454242-0i, 0.389950965517827-0i, 0.381632144553321-0i, 
0.367558551069284-0i, 3.60280364014244e-01-5e-16i, 0.347893758917387-0i, 
0.341478635043236-0i, 0.330493317071674-0i, 0.324802431875611-0i, 
0.314994197176915-0i, 0.309917410310926-0i, 0.301107810401305-0i, 
0.296556594272976+0i, 0.288601802571908-0i, 0.284504171464395-0i, 
0.277286955824542-0i, 0.273583763646231-0i, 0.26700759770719+0i, 
0.26364979107223-0i, 0.257634467078557-0i, 0.254581017375152+0i, 
0.249059331483202+0i, 0.24627565746035+0i, 0.2411908732577-0i, 
0.238647623265162-0i, 0.233951508109455+0i, 0.231623609628703-0i, 
0.227274898173712-0i, 0.225140808472646-0i, 0.221103988621153+0i, 
0.219145098479366+0i, 0.215389443399532-0i, 0.213589598563074-0i, 
0.210088388418703+0i, 0.208433502489124-0i, 0.2051633938314-0i, 
0.203641132812338-0i, 0.200581643918063+0i, 0.199181167395396-0i, 
0.196314255399943-0i, 0.195026002835555-0i, 0.192335714098538+0i, 
0.191151227327474-0i, 0.188623406645033-0i, 0.187535181627351-0i, 
0.185157229050967+0i, 0.184158591418855-0i, 0.181919257833232-0i, 
0.181004257912379-0i, 0.178893472359142+0i, 0.178056796221936-0i, 
0.176065519372737-0i, 0.175302413162936+0i, 0.173422512448212+0i, 
0.17272871775096+0i, 0.170952860514817+0i, 0.170324558966289+0i, 
0.168646120699542+0i, 0.168079886363804+0i, 0.166492871607943+0i, 
0.165985629914994+0i, 0.164484603861996+0i, 0.16403359611373+0i, 
0.162613625273149-0i, 0.162216377896559-0i, 0.160872978481378+0i, 
0.160527276347667-0i, 0.159256369257407-0i, 0.158960232499559-0i, 
0.157758103964362+0i, 0.157509767819071-0i, 0.156373034920093-0i, 
0.156170932196781+0i, 0.155096512603298-0i, 0.154939258446492-0i, 
0.153924343813227-0i, 0.153810722477679-0i, 0.152852755031539-0i, 
0.152781708433716-0i, 0.151878360351006-0i, 0.151848978197746-0i, 
0.150998133432552-0i, 0.151009644759489-0i, 0.150209383034337-0i, 
0.150261149013515-0i, 0.149509731726461-0i, 0.149601239625448-0i, 
0.148897097463633-0i, 0.149027955658878-0i, 0.148369677739626-0i, 
0.148539611703865-0i, 0.147925936091301-0i, 0.148134785290617-0i, 
0.147564590758323-0i, 0.14781230640802-0i, 0.147284605338724-0i, 
0.147571248980157-0i, 0.147085181310879-0i, 0.147410924182577-0i, 
0.146965752319284-0i, 0.147330875506848-0i, 0.14692598014679+0i, 
0.147330875506848-0i, 0.146965752319284-0i, 0.147410924182577+0i, 
0.147085181310879+0i, 0.147571248980157-0i, 0.147284605338724-0i, 
0.14781230640802-0i, 0.147564590758323+0i, 0.148134785290617+0i, 
0.147925936091301-0i, 0.148539611703865+0i, 0.148369677739626+0i, 
0.149027955658878+0i, 0.148897097463633-0i, 0.149601239625448+0i, 
0.149509731726461+0i, 0.150261149013515+0i, 0.150209383034337+0i, 
0.151009644759489+0i, 0.150998133432552+0i, 0.151848978197746+0i, 
0.151878360351006+0i, 0.152781708433716-0i, 0.152852755031539+0i, 
0.153810722477679+0i, 0.153924343813227-0i, 0.154939258446492-0i, 
0.155096512603298+0i, 0.156170932196781+0i, 0.156373034920093+0i, 
0.157509767819071+0i, 0.157758103964362+0i, 0.15896023249956+0i, 
0.159256369257407+0i, 0.160527276347667-0i, 0.160872978481378+0i, 
0.162216377896559+0i, 0.16261362527315-0i, 0.16403359611373-0i, 
0.164484603861996+0i, 0.165985629914994-0i, 0.166492871607943+0i, 
0.168079886363804+0i, 0.168646120699542+0i, 0.170324558966289+0i, 
0.170952860514817+0i, 0.17272871775096-0i, 0.173422512448212+0i, 
0.175302413162936-0i, 0.176065519372737-0i, 0.178056796221936+0i, 
0.178893472359142+0i, 0.181004257912379+0i, 0.181919257833233+0i, 
0.184158591418855+0i, 0.185157229050967+0i, 0.18753518162735+0i, 
0.188623406645034+0i, 0.191151227327474+0i, 0.192335714098538+0i, 
0.195026002835555+0i, 0.196314255399943+0i, 1.99181167395396e-01+8e-16i, 
0.200581643918063+0i, 0.203641132812338-0i, 0.2051633938314-0i, 
0.208433502489124+0i, 0.210088388418703+0i, 0.213589598563074+0i, 
0.215389443399532+0i, 0.219145098479366+0i, 0.221103988621153+0i, 
0.225140808472646-0i, 0.227274898173712+0i, 0.231623609628703+0i, 
0.233951508109455+0i, 0.238647623265162+0i, 0.2411908732577+0i, 
0.24627565746035+0i, 0.249059331483202+0i, 0.254581017375152-0i, 
0.257634467078558+0i, 0.26364979107223+0i, 0.26700759770719+0i, 
0.273583763646231-0i, 0.277286955824542+0i, 0.284504171464395-0i, 
0.288601802571908+0i, 0.296556594272976+0i, 0.301107810401305+0i, 
0.309917410310927+0i, 0.314994197176915+0i, 0.324802431875611+0i, 
0.330493317071674+0i, 0.341478635043236+0i, 0.347893758917387+0i, 
0.360280364014244+0i, 0.367558551069284+0i, 0.381632144553322+0i, 
0.389950965517828-0i, 0.406081493454242+0i, 0.415671913112043+0i, 
0.434347257883855+0i, 0.445515520197509-0i, 0.467392832479701+0i, 
0.480554151835486+0i, 0.506540660948934+0i, 0.52227292565137-0i, 
0.553658128381716+0i, 0.57279108904066+0i, 0.611473061802516+0i, 
0.635243909995603-0i, 0.68413870746406+0i, 0.714480231619985+0i, 
7.78314654233925e-01+8e-16i, 0.818430470154111-0i, 0.905415801247111+0i, 
0.961045067362698+0i, 1.08683693974652+0i, 1.16942031675447-0i, 
1.36808986084188+0i, 1.50430859676396+0i, 1.86686853541764+0i, 
2.13712917024748-0i, 3.01541673858188+0i, 3.82533086831046+0i, 
8.85960049519153+0i) 


assertThat(stats:::fft(z=c(1, 0.818181818181818, 0.765395894428152, 0.73538036915646, 
0.714665429180222, 0.698958496670767, 0.686364649883906, 0.675885800267358, 
0.666933670462492, 0.659133276655913, 0.652231357528626, 0.64604906977954, 
0.64045557133989, 0.635352339695747, 0.630663392539321, 0.626328936233209, 
0.622301097414989, 0.618540969938161, 0.615016519967003, 0.611701067029176, 
0.608572161315471, 0.605610739605907, 0.602800480953443, 0.600127308088905, 
0.597578996801903, 0.595144866468698, 0.59281553235336, 0.590582705489506, 
0.588439029607511, 0.586377947192073, 0.584393588656736, 0.582480680019562, 
0.58063446550286, 0.578850642260147, 0.577125305025393, 0.5754548989327, 
0.573836179104479, 0.572266175878475, 0.570742164757627, 0.569261640335428, 
0.567822293583632, 0.566421991996496, 0.565058762172197, 0.563730774482015, 
0.562436329534869, 0.561173846191357, 0.559941850919806, 0.558738968318475, 
0.557563912654293, 0.556415480290433, 0.555292542893277, 0.554194041324745, 
0.553118980138858, 0.552066422612428, 0.551035486249006, 0.550025338703179, 
0.549035194079051, 0.548064309562554, 0.547111982352193, 0.546177546857142, 
0.5452603721353, 0.544359859547133, 0.543475440603921, 0.542606574991444, 
0.541752748752276, 0.540913472611684, 0.540088280433787, 0.53927672779602, 
0.538478390671229, 0.537692864207814, 0.53691976159932, 0.536158713035749, 
0.535409364729619, 0.534671378010488, 0.533944428482262, 0.533228205238154, 
0.53252241012864, 0.531826757078178, 0.531140971446872, 0.530464789433572, 
0.529797957517251, 0.529140231933741, 0.528491378185202, 0.52785117057989, 
0.527219391800021, 0.526595832495704, 0.525980290903074, 0.52537257248493, 
0.524772489592315, 0.52417986114557, 0.523594512333571, 0.523016274329889, 
0.522444984024777, 0.521880483771914, 0.521322621148962, 0.520771248731036, 
0.520226223876268, 0.519687408522693, 0.519154668995761, 0.518627875825801, 
0.518106903574846, 0.517591630672235, 0.517081939258476, 0.516577715036869, 
0.516078847132439, 0.515585227957755, 0.515096753085223, 0.514613321125499, 
0.514134833611668, 0.513661194888857, 0.513192312008995, 0.512728094630425, 
0.512268454922106, 0.511813307472153, 0.511362569200491, 0.510916159275392, 
0.5104739990337, 0.510036011904542, 0.509602123336354, 0.509172260727045, 
0.508746353357135, 0.508324332325731, 0.507906130489182, 0.507491682402288, 
0.507080924261938, 0.506673793853056, 0.506270230496742, 0.505870175000498, 
0.505473569610454, 0.505870175000498, 0.506270230496742, 0.506673793853056, 
0.507080924261938, 0.507491682402288, 0.507906130489182, 0.508324332325731, 
0.508746353357135, 0.509172260727045, 0.509602123336354, 0.510036011904542, 
0.5104739990337, 0.510916159275392, 0.511362569200491, 0.511813307472153, 
0.512268454922106, 0.512728094630425, 0.513192312008995, 0.513661194888857, 
0.514134833611668, 0.514613321125499, 0.515096753085223, 0.515585227957755, 
0.516078847132439, 0.516577715036869, 0.517081939258476, 0.517591630672235, 
0.518106903574846, 0.518627875825801, 0.519154668995761, 0.519687408522693, 
0.520226223876268, 0.520771248731036, 0.521322621148962, 0.521880483771914, 
0.522444984024777, 0.523016274329889, 0.523594512333571, 0.52417986114557, 
0.524772489592315, 0.52537257248493, 0.525980290903074, 0.526595832495704, 
0.527219391800021, 0.52785117057989, 0.528491378185202, 0.529140231933741, 
0.529797957517251, 0.530464789433572, 0.531140971446872, 0.531826757078178, 
0.53252241012864, 0.533228205238154, 0.533944428482262, 0.534671378010488, 
0.535409364729619, 0.536158713035749, 0.53691976159932, 0.537692864207814, 
0.538478390671229, 0.53927672779602, 0.540088280433787, 0.540913472611684, 
0.541752748752276, 0.542606574991444, 0.543475440603921, 0.544359859547133, 
0.5452603721353, 0.546177546857142, 0.547111982352193, 0.548064309562554, 
0.549035194079051, 0.550025338703179, 0.551035486249006, 0.552066422612428, 
0.553118980138858, 0.554194041324745, 0.555292542893277, 0.556415480290433, 
0.557563912654293, 0.558738968318475, 0.559941850919806, 0.561173846191357, 
0.562436329534869, 0.563730774482015, 0.565058762172197, 0.566421991996496, 
0.567822293583632, 0.569261640335428, 0.570742164757627, 0.572266175878475, 
0.573836179104479, 0.5754548989327, 0.577125305025393, 0.578850642260147, 
0.58063446550286, 0.582480680019562, 0.584393588656736, 0.586377947192073, 
0.588439029607511, 0.590582705489506, 0.59281553235336, 0.595144866468698, 
0.597578996801903, 0.600127308088905, 0.602800480953443, 0.605610739605907, 
0.608572161315471, 0.611701067029176, 0.615016519967003, 0.618540969938161, 
0.622301097414989, 0.626328936233209, 0.630663392539321, 0.635352339695747, 
0.64045557133989, 0.64604906977954, 0.652231357528626, 0.659133276655913, 
0.666933670462492, 0.675885800267358, 0.686364649883906, 0.698958496670767, 
0.714665429180222, 0.73538036915646, 0.765395894428152, 0.818181818181818
))
,  equalTo( expected ) ) 
 

