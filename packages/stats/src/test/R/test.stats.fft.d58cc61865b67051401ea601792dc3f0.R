library(hamcrest)

 
 
expected <- c(22.3316729109882-0i, 21.8838339355503-0i, 22.8140076820741+0i, 
25.113614691932+0i, 28.6725686370894+0i, 33.285021409107+0i, 
38.6627128002767+0i, 44.4549635524019+0i, 50.2738170603627+0i, 
55.722417231925+0i, 60.4244413016376+0i, 64.0523084658107+0i, 
66.35196633132+0i, 67.1623115606189+0i, 66.4277093113007+0i, 
64.2026065286889+0i, 60.6478455803165+0i, 56.0189293713165+0i, 
50.6471164507628+0i, 4.49147854144359e+01+5e-14i, 39.2269579017972+0i, 
33.981172995455+0i, 2.95380385519234e+01+5e-14i, 2.61947359268165e+01+6e-14i, 
2.41635269291934e+01+7e-14i, 23.5569228914541+0i, 24.380655439411+0i, 
26.534977287247+0i, 2.98241668698945e+01+6e-14i, 3.39734641747523e+01+6e-14i, 
38.6520776664144+0i, 43.5004202506709+0i, 48.1593942863345+0i, 
5.22993791065742e+01+6e-14i, 5.56465934204393e+01+6e-14i, 5.80047088970714e+01+6e-14i, 
5.9269965200272e+01+7e-14i, 5.94385522703796e+01+6e-14i, 5.86056429296032e+01+8e-14i, 
5.6956129790583e+01+9e-14i, 5.47477922425587e+01+8e-14i, 5.22882387234495e+01+9e-14i, 
4.99074869514946e+01+9e-14i, 4.79284182346177e+01+1e-13i, 4.66375402596799e+01+1e-13i, 
4.62584981976582e+01+8e-14i, 4.69305838201259e+01+9e-14i, 4.8694119215158e+01+1e-13i, 
5.14840627379524e+01+1e-13i, 5.51325397145787e+01+1e-13i, 5.93802884326863e+01+7e-14i, 
6.38962882912488e+01+8e-14i, 6.83041585107039e+01+8e-14i, 7.22133366786843e+01+7e-14i, 
7.52526138311791e+01+7e-14i, 7.71033532577765e+01+7e-14i, 7.75296766263943e+01+7e-14i, 
7.64030705899238e+01+6e-14i, 7.37192406182324e+01+8e-14i, 6.96055913289579e+01+9e-14i, 
6.43184047800706e+01+7e-14i, 5.82295693256539e+01+8e-14i, 5.18035233027572e+01+9e-14i, 
4.55658582263694e+01+1e-13i, 4.00657148310886e+01+1e-13i, 3.58346476375767e+01+9e-14i, 
3.33449853147799e+01+1e-13i, 3.29708442015168e+01+1e-13i, 3.49548463954872e+01+1e-13i, 
3.93832548178333e+01+2e-13i, 4.61716862149899e+01+1e-13i, 5.50628360794969e+01+1e-13i, 
6.56367976659221e+01+1e-13i, 7.73336415657244e+01+1e-13i, 8.94870094211423e+01+1e-13i, 
101.366632971654+0i, 112.226981325371+0i, 121.358719867051+0i, 
128.139375263114+0i, 132.079568026009+0i, 132.861404102053+0i, 
130.36609785704+0i, 124.68860006422+0i, 116.137878973182+0i, 
105.222489930527+0i, 9.2622100005414e+01+9e-14i, 7.91466352579195e+01+1e-13i, 
6.56856175196893e+01+1e-13i, 5.31509891576623e+01+1e-13i, 4.24172338873867e+01+2e-13i, 
3.42628502594637e+01+9e-14i, 2.93172012285903e+01+1e-13i, 2.80164474510432e+01+1e-13i, 
3.05716930375962e+01+1e-13i, 3.6951668742363e+01+2e-13i, 4.68813036382895e+01+1e-13i, 
5.98564593680878e+01+1e-13i, 7.51739959900545e+01+1e-13i, 9.19752826429844e+01+1e-13i, 
109.30033405397+0i, 126.149011247483+0i, 141.545224507473+0i, 
154.599854595211+0i, 164.568180805099+0i, 170.897967283949+0i, 
173.264987322907+0i, 171.593615516864+0i, 166.061130605538+0i, 
157.085476869442+0i, 145.297352153637+0i, 131.498548002497+0i, 
116.609388680949+0i, 101.60883749735+0i, 8.74713115683527e+01+1e-13i, 
7.51044384320573e+01+1e-13i, 6.52918880586726e+01+8e-14i, 5.86450307780618e+01+1e-13i, 
5.55665342584862e+01+1e-13i, 5.62281674498273e+01+1e-13i, 6.05640871465494e+01+1e-13i, 
6.82798141839853e+01+7e-14i, 7.88760366603898e+01+9e-14i, 9.16853817223948e+01+8e-14i, 
105.919444128275+0i, 120.722706945882+0i, 135.229580421692+0i, 
148.620644556688+0i, 160.174315119605+0i, 169.310547985493+0i, 
175.623820681517+0i, 178.9034348662+0i, 179.140108970747+0i, 
176.518808490826+0i, 171.398721831206+0i, 164.282164011023+0i, 
155.77491811435+0i, 146.54105594852+0i, 137.255580829976+0i, 
128.558289937608+0i, 121.012062701253+0i, 115.068364537768+0i, 
111.042147378011+0i, 109.097578601937+0i, 109.245196447561+0i, 
111.350235930512+0i, 115.15105830126+0i, 120.285908106951+0i, 
126.325665262611+0i, 132.809893042079+0i, 139.283329444976+0i, 
145.33003540024+0i, 150.602688492038+0i, 154.84496950307+0i, 
157.90559184216+0i, 159.743221447809+0i, 160.422271359834+0i, 
160.100273224502+0i, 159.008172443953+0i, 157.425416076583+0i, 
155.65206480957+0i, 153.980337292594+0i, 152.66797658328+0i, 
151.915619536806+0i, 151.849970577935+0i, 152.514064362092+0i, 
153.865290609759+0i, 155.781198945462+0i, 158.072454778418+0i, 
160.501730681658+0i, 162.806837562444+0i, 164.726063453263+0i, 
166.023520516496+0i, 166.512314717195+0i, 166.073544972042-0i, 
164.669492664958-0i, 162.349848730771+0i, 159.250404218679-0i, 
155.58425440071-0i, 151.626185744748-0i, 147.691479686752-0i, 
144.110831895259-0i, 141.203413479613-0i, 139.25026518511-0i, 
138.470203887274-0i, 139.000233504294+0i, 140.882104573529-0i, 
144.056185701273-0i, 148.363233962218-0i, 153.554025707028-0i, 
159.306183691245-0i, 165.246960570287-0i, 170.98025835863-0i, 
176.115816712947-0i, 180.298317679862-0i, 183.234145987923-0i, 
184.713713320959-0i, 184.627589548638-0i, 182.975157849089-0i, 
179.865087250455-0i, 175.507550390565-0i, 170.198756634846-0i, 
164.298970708583-0i, 158.205697462723-0i, 152.324093949743-0i, 
147.036890342108-0i, 142.6761435475-0i, 139.49900773102-0i, 137.669394672862-0i, 
137.24693780284-0i, 138.184102384742-0i, 140.331645156948-0i, 
143.45196976953-0i, 147.239301216182-0i, 151.345062357193-0i, 
155.406421507477-0i, 159.075725190577-0i, 162.048455473848-0i, 
164.087463696423-0i, 165.041524104433-0i, 164.856699984453-0i, 
163.57958686683-0i, 161.352147858441-0i, 158.398534235904-0i, 
155.004936569434-0i, 151.494085912505-0i, 148.196474692175-0i, 
145.420655899291-0i, 143.425082335093-0i, 142.393854694302-0i, 
142.418463124749-0i, 143.48715164017-0i, 145.482942087426-0i, 
148.190669193753-0i, 151.312653290317-0i, 154.491929200512-0i, 
157.341314552985-0i, 159.47608961619-0i, 160.547715938898-0i, 
160.27587261533-0i, 158.476152095748-0i, 155.081031201235-0i, 
150.152200132586-0i, 143.882960325481-0i, 136.59014558475-0i, 
128.695824953069-0i, 120.699849559929-0i, 113.145047529096-0i, 
106.577492803071-0i, 101.504725480087-0i, 9.83550449795301e+01-7e-14i, 
9.74410101583083e+01-8e-14i, 9.89300565332306e+01-8e-14i, 102.824691901697-0i, 
108.954086890877-0i, 116.978080501135-0i, 126.403728861773-0i, 
136.613602601082-0i, 146.904152277499-0i, 156.531678473109-0i, 
164.762823143543-0i, 170.926090342787-0i, 174.460741403334-0i, 
174.959508467801-0i, 172.20192842305-0i, 166.175695274537-0i, 
157.084223652394-0i, 145.339555286559-0i, 131.540758517071-0i, 
116.438996211023-0i, 100.891396400264-0i, 8.58066829791151e+01-1e-13i, 
7.20861503212577e+01-1e-13i, 6.05639485415637e+01-9e-14i, 5.1950755166885e+01-7e-14i, 
4.67847333153645e+01-6e-14i, 4.53932254891312e+01-1e-13i, 4.78679348653854e+01-1e-13i, 
5.40554494188996e+01-8e-14i, 6.35639297638012e+01-8e-14i, 7.57856809388224e+01-9e-14i, 
8.99342383175683e+01-9e-14i, 105.093594941579-0i, 120.27635261663-0i, 
134.486952005241-0i, 146.785772458292-0i, 156.349816832459-0i, 
162.525916099824-0i, 164.872888449579-0i, 163.189833322284-0i, 
157.528680589583-0i, 148.190183430834-0i, 135.703665901543-0i, 
120.791934574739-0i, 104.323761656722-0i, 8.72571755886076e+01-9e-14i, 
7.05773974446726e+01-1e-13i, 5.52335966690412e+01-1e-13i, 4.20786860660905e+01-8e-14i, 
3.18161321213243e+01-6e-14i, 2.49572417469494e+01-5e-14i, 2.17916384425505e+01-1e-13i, 
2.2372713792574e+01-1e-13i, 2.65188005187847e+01-8e-14i, 3.38297346623939e+01-7e-14i, 
4.37174326421122e+01-8e-14i, 5.5448176320994e+01-9e-14i, 6.81935397289536e+01-1e-13i, 
8.10863556727126e+01-1e-13i, 9.32778435853612e+01-1e-13i, 103.99201731795-0i, 
112.573759162513-0i, 118.527461052287-0i, 121.543855162252-0i, 
121.513529425385-0i, 118.526584138399-0i, 112.858863960026-0i, 
104.946125185594-0i, 9.53483061388514e+01-6e-14i, 8.47067033723497e+01-6e-14i, 
7.36972761069877e+01-5e-14i, 6.29834802974584e+01-6e-14i, 5.31719641620332e+01-6e-14i, 
44.7741494731328-0i, 38.176205049217-0i, 33.6192332556348-0i, 
3.11906909309679e+01-7e-14i, 3.08272143307412e+01-7e-14i, 3.23281773955941e+01-6e-14i, 
35.3785457420621-0i, 3.95789503816222e+01-6e-14i, 4.44804397505107e+01-7e-14i, 
4.96211068082841e+01-7e-14i, 5.45617444871279e+01-7e-14i, 5.89178556823428e+01-6e-14i, 
6.23857150223264e+01-7e-14i, 6.47607159711294e+01-6e-14i, 6.59468936313516e+01-6e-14i, 
6.59572378622027e+01-5e-14i, 64.9051458108393-0i, 62.9880507772906-0i, 
60.4648532395185-0i, 57.6292261738991-0i, 54.7811386329914-0i, 
52.1990210775199-0i, 50.1148806387463-0i, 48.694376975354-0i, 
48.0234163903408-0i, 48.1022518756378-0i, 48.8474368830898-0i, 
50.101322871603-0i, 51.648167792868-0i, 53.23538401177-0i, 54.5980418617361-0i, 
55.4844908157481-0i, 55.6808829813288-0i, 55.0324879665933-0i, 
53.4599643196016-0i, 50.9691773398485-0i, 47.6536910781817-0i, 
43.6896699465527-0i, 39.3235534123008-0i, 34.8534652102238-0i, 
30.6058384168731-0i, 26.9091380055887+0i, 24.0668111696973+0i
) 


assertThat(stats:::fft(inverse=TRUE,z=c(101.119971428571+0i, -29.0928136430285+4.7733132342952i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, -9.96827469726697-3.36903966620577i, 
0+0i, 10.5831624331481-2.3897986984906i, 0+0i, -10.916223351644+6.3427574475901i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, -10.916223351644-6.3427574475901i, 0+0i, 10.5831624331481+2.3897986984906i, 
0+0i, -9.96827469726698+3.36903966620576i, 0+0i, 0+0i, 0+0i, 
0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, 0+0i, -29.0928136430286-4.7733132342952i
))
,  equalTo( expected ) ) 
 

