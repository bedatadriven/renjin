library(hamcrest)

 
 
expected <- c(17.2143299483298+0i, 6.76599764586189+0i, 4.49961362546237+0i, 
3.83355704690092+0i, 3.27212196280015+0i, 2.98108718667152+0i, 
2.70382878249087+0i, 2.53123350193135+0i, 2.35932982450935+0i, 
2.24174315255646+0i, 2.12208731753953+0i, 2.03532122367732+0i, 
1.94596838249423+0i, 1.87853035798804+0i, 1.80857781503675+0i, 
1.75421249064897+0i, 1.69755778050644+0i, 1.65252833348418+0i, 
1.60545677854942+0i, 1.56737393281723+0i, 1.5274786255341+0i, 
1.49473330403971+0i, 1.46037742254704+0i, 1.43184062426539+0i, 
1.40186724658337+0i, 1.3767200503212+0i, 1.3502852597442+0i, 
1.32791710835833+0i, 1.30438893603913+0i, 1.28433397413757+0i, 
1.26322854509195+0i, 1.2451242454265+0i, 1.22606395978411+0i, 
1.20962336140585+0i, 1.19230865607987+0i, 1.17730121660969+0i, 
1.1614909865636+0i, 1.14772905604446+0i, 1.13322676280759+0i, 
1.12055582593288+0i, 1.10719943904347+0i, 1.09549094383588+0i, 
1.08314552511992+0i, 1.07229152442353+0i, 1.06084367190958+0i, 
1.05075275947208+0i, 1.04010638385639+0i, 1.03070057061374+0i, 
1.02077364235838+0i, 1.01198592601566+0i, 1.0027079400285+0i, 
0.994480392987961+0i, 0.985790371019104+0i, 0.978072620774398+0i, 
0.969917521752837+0i, 0.962665531894866+0i, 0.954998975275925+0i, 
0.948174059215807+0i, 0.94095529101944+0i, 0.93452330764575+0i, 
0.927716356486324+0i, 0.921647049354306+0i, 0.915220032541115+0i, 
0.909486483257423+0i, 0.903411032421977+0i, 0.897989205601623+0i, 
0.892239988264307+0i, 0.887108350459375+0i, 0.881662669161881+0i, 
0.876801867956281+0i, 0.871639322531337+0i, 0.867031914888858+0i, 
0.862134116450543+0i, 0.857764337627759+0i, 0.853114665184355+0i, 
0.848968231243797+0i, 0.844551623634131+0i, 0.840615561939221+0i, 
0.836418339199702+0i, 0.83268084233145+0i, 0.828690551707947+0i, 
0.825140851081431+0i, 0.821346133777203+0i, 0.817974389903438+0i, 
0.814364865353571+0i, 0.811162072227445+0i, 0.807728237251174+0i, 
0.804686138777318+0i, 0.801419279411954+0i, 0.798530296130032+0i, 
0.795422410316969+0i, 0.7926795749724+0i, 0.78972330456473+0i, 
0.78712020530398+0i, 0.784308776109999+0i, 0.781839506271176+0i, 
0.779166675049531+0i, 0.776825788677351+0i, 0.774285796166082+0i, 
0.772068268511593+0i, 0.769655797711461+0i, 0.767556990086342+0i, 
0.765267129134018+0i, 0.763282757580784+0i, 0.761110966643754+0i, 
0.759237073960047+0i, 0.757179155666049+0i, 0.755412086385911+0i, 
0.75346415936788+0i, 0.751800537357697+0i, 0.74995901255287+0i, 
0.748395720926131+0i, 0.746657280316936+0i, 0.745191443411566+0i, 
0.743553020937626+0i, 0.742181988133407+0i, 0.740640752539611+0i, 
0.73936208372229+0i, 0.737915423138436+0i, 0.736726875641977+0i, 
0.735372383715776+0i, 0.734271900595846+0i, 0.733007364023767+0i, 
0.731993063534072+0i, 0.730816450854112+0i, 0.729886617013544+0i, 
0.728796068541109+0i, 0.727949142693712+0i, 0.726942961496667+0i, 
0.726177534778864+0i, 0.725254178600804+0i, 0.724568985241236+0i, 
0.723727059293532+0i, 0.723120970680438+0i, 0.722359221233665+0i, 
0.721831240693362+0i, 0.721148549407727+0i, 0.720697807645326+0i, 
0.720093186587633+0i, 0.719718937748017+0i, 0.719191525049975+0i, 
0.718893143363293+0i, 0.718442199482336+0i, 0.718219176463902+0i, 
0.717844081013635+0i, 0.717696023193358+0i, 0.717396272316141+0i, 
0.717322899477462+0i, 0.717098103736587+0i, 0.717099247649415+0i, 
0.716949130423053+0i, 0.71702473405958+0i, 0.716949130423053+0i, 
0.717099247649415+0i, 0.717098103736587+0i, 0.717322899477463+0i, 
0.717396272316141+0i, 0.717696023193358+0i, 0.717844081013635+0i, 
0.718219176463902+0i, 0.718442199482336+0i, 0.718893143363294+0i, 
0.719191525049975+0i, 0.719718937748017+0i, 0.720093186587633+0i, 
0.720697807645325+0i, 0.721148549407727+0i, 0.721831240693363+0i, 
0.722359221233665+0i, 0.723120970680438+0i, 0.723727059293532+0i, 
0.724568985241236+0i, 0.725254178600804+0i, 0.726177534778865+0i, 
0.726942961496667+0i, 0.727949142693712+0i, 0.728796068541109+0i, 
0.729886617013544+0i, 0.730816450854112+0i, 0.731993063534072+0i, 
0.733007364023767+0i, 0.734271900595846+0i, 0.735372383715776+0i, 
0.736726875641977+0i, 0.737915423138436+0i, 0.739362083722289+0i, 
0.740640752539611+0i, 0.742181988133408+0i, 0.743553020937626+0i, 
0.745191443411566+0i, 0.746657280316936+0i, 0.748395720926131+0i, 
0.74995901255287+0i, 0.751800537357697+0i, 0.75346415936788+0i, 
0.755412086385911+0i, 0.757179155666049+0i, 0.759237073960047+0i, 
0.761110966643754+0i, 0.763282757580785+0i, 0.765267129134018+0i, 
0.767556990086342+0i, 0.769655797711461+0i, 0.772068268511593+0i, 
0.774285796166082+0i, 0.776825788677351+0i, 0.779166675049531+0i, 
0.781839506271176+0i, 0.784308776109999+0i, 0.787120205303981+0i, 
0.78972330456473+0i, 0.7926795749724+0i, 0.795422410316969+0i, 
0.798530296130032+0i, 0.801419279411954+0i, 0.804686138777318+0i, 
0.807728237251174+0i, 0.811162072227445+0i, 0.814364865353571+0i, 
0.817974389903439+0i, 0.821346133777203+0i, 0.82514085108143+0i, 
0.828690551707947+0i, 0.83268084233145+0i, 0.836418339199702+0i, 
0.840615561939221+0i, 0.844551623634131+0i, 0.848968231243797+0i, 
0.853114665184355+0i, 0.857764337627758+0i, 0.862134116450543+0i, 
0.867031914888858+0i, 0.871639322531337+0i, 0.876801867956281+0i, 
0.881662669161881+0i, 0.887108350459375+0i, 0.892239988264307+0i, 
0.897989205601623+0i, 0.903411032421977+0i, 0.909486483257423+0i, 
0.915220032541115+0i, 0.921647049354306+0i, 0.927716356486324+0i, 
0.934523307645751+0i, 0.94095529101944+0i, 0.948174059215807+0i, 
0.954998975275925+0i, 0.962665531894866+0i, 0.969917521752837+0i, 
0.978072620774398+0i, 0.985790371019104+0i, 0.994480392987962+0i, 
1.0027079400285+0i, 1.01198592601566+0i, 1.02077364235838+0i, 
1.03070057061374+0i, 1.04010638385639+0i, 1.05075275947208+0i, 
1.06084367190958+0i, 1.07229152442353+0i, 1.08314552511992+0i, 
1.09549094383588+0i, 1.10719943904347+0i, 1.12055582593289+0i, 
1.13322676280759+0i, 1.14772905604446+0i, 1.1614909865636+0i, 
1.17730121660969+0i, 1.19230865607987+0i, 1.20962336140585+0i, 
1.22606395978411+0i, 1.2451242454265+0i, 1.26322854509195+0i, 
1.28433397413757+0i, 1.30438893603913+0i, 1.32791710835833+0i, 
1.3502852597442+0i, 1.3767200503212+0i, 1.40186724658337+0i, 
1.4318406242654+0i, 1.46037742254704+0i, 1.49473330403971+0i, 
1.5274786255341+0i, 1.56737393281724+0i, 1.60545677854942+0i, 
1.65252833348419+0i, 1.69755778050644+0i, 1.75421249064897+0i, 
1.80857781503675+0i, 1.87853035798804+0i, 1.94596838249423+0i, 
2.03532122367732+0i, 2.12208731753953+0i, 2.24174315255646+0i, 
2.35932982450935+0i, 2.53123350193135+0i, 2.70382878249087+0i, 
2.98108718667152+0i, 3.27212196280015+0i, 3.83355704690092+0i, 
4.49961362546237+0i, 6.7659976458619+0i) 


assertThat(stats:::fft(inverse=FALSE,z=c(1.16062978041434, 0.366514667499264, 0.258226243010845, 0.209574921863875, 
0.18059115607419, 0.16086271045264, 0.146340382425665, 0.135083429931383, 
0.126031447513301, 0.118550128711142, 0.112233933328991, 0.106809988595619, 
0.102087097943432, 0.0979268086855492, 0.094226086264293, 0.0909064680490198, 
0.0879070160575547, 0.0851795907383465, 0.0826855937122238, 0.0803936689398167, 
0.0782780460729794, 0.0763173243023653, 0.0744935647142573, 0.0727916027787821, 
0.0711985205630849, 0.0697032366094175, 0.0682961836964944, 0.0669690530715999, 
0.0657145895414403, 0.0645264258918732, 0.0633989480201066, 0.0623271842694416, 
0.0613067139980275, 0.0603335915536144, 0.0594042826789734, 0.0585156110163421, 
0.057664712869572, 0.0568489987593387, 0.056066120598458, 0.0553139435419255, 
0.0545905217450995, 0.0538940774048775, 0.0532229825712918, 0.0525757433070947, 
0.051950985845493, 0.0513474444549734, 0.0507639507679851, 0.0501994243693676, 
0.0496528644725487, 0.0491233425380589, 0.0486099957108927, 0.0481120209715376, 
0.0476286699107725, 0.0471592440511516, 0.0467030906488711, 0.0462595989188234, 
0.0458281966333537, 0.0454083470517938, 0.0449995461434327, 0.044601320071367, 
0.0442132229087647, 0.0438348345626068, 0.0434657588829993, 0.0431056219387807, 
0.0427540704424168, 0.0424107703091546, 0.0420754053371236, 0.0417476759965708, 
0.0414272983177305, 0.0411140028679745, 0.040807533809899, 0.0405076480328902, 
0.0402141143514924, 0.0399267127645933, 0.039645233770049, 0.0393694777299149, 
0.0390992542819271, 0.0388343817933054, 0.0385746868533296, 0.0383200038014792, 
0.0380701742882299, 0.0378250468658688, 0.0375844766069372, 0.0373483247481212, 
0.0371164583576123, 0.03688875002413, 0.0366650775659613, 0.036445323758512, 
0.0362293760789949, 0.0360171264669954, 0.0358084710997623, 0.0356033101811652, 
0.0354015477433469, 0.0352030914601802, 0.0350078524717065, 0.0348157452188014, 
0.034626687287371, 0.0344405992614364, 0.0342574045845138, 0.0340770294287428, 
0.0338994025712554, 0.0337244552773187, 0.0335521211898167, 0.0333823362246678, 
0.0332150384718071, 0.0330501681013857, 0.032887667274866, 0.0327274800607135, 
0.0325695523544071, 0.0324138318025103, 0.0322602677305597, 0.0321088110745477, 
0.0319594143157899, 0.0318120314189807, 0.031666617773254, 0.0315231301360799, 
0.0313815265798363, 0.0312417664409059, 0.03110381027116, 0.0309676197916972, 
0.0308331578487139, 0.0307003883713925, 0.0305692763316986, 0.030439787705986, 
0.0303118894383138, 0.0301855494053872, 0.0300607363830367, 0.029937420014157, 
0.0298155707780318, 0.0296951599609723, 0.0295761596282064, 0.0294585425969532, 
0.0293422824106265, 0.02922735331411, 0.029113730230054, 0.0290013887361416, 
0.0288903050432807, 0.0287804559746751, 0.0286718189457347, 0.028564371944785, 
0.0284580935145382, 0.0283529627342913, 0.0282489592028168, 0.0281460630219155, 
0.0280442547806008, 0.0279435155398858, 0.0278438268181463, 0.0277451705770354, 
0.027647529207923, 0.0275508855188391, 0.0274552227218987, 0.0273605244211864, 
0.0274552227218987, 0.0275508855188391, 0.027647529207923, 0.0277451705770354, 
0.0278438268181463, 0.0279435155398858, 0.0280442547806008, 0.0281460630219155, 
0.0282489592028168, 0.0283529627342913, 0.0284580935145382, 0.028564371944785, 
0.0286718189457347, 0.0287804559746751, 0.0288903050432807, 0.0290013887361416, 
0.029113730230054, 0.02922735331411, 0.0293422824106265, 0.0294585425969532, 
0.0295761596282064, 0.0296951599609723, 0.0298155707780318, 0.029937420014157, 
0.0300607363830367, 0.0301855494053872, 0.0303118894383138, 0.030439787705986, 
0.0305692763316986, 0.0307003883713925, 0.0308331578487139, 0.0309676197916972, 
0.03110381027116, 0.0312417664409059, 0.0313815265798363, 0.0315231301360799, 
0.031666617773254, 0.0318120314189807, 0.0319594143157899, 0.0321088110745477, 
0.0322602677305597, 0.0324138318025103, 0.0325695523544071, 0.0327274800607135, 
0.032887667274866, 0.0330501681013857, 0.0332150384718071, 0.0333823362246678, 
0.0335521211898167, 0.0337244552773187, 0.0338994025712554, 0.0340770294287428, 
0.0342574045845138, 0.0344405992614364, 0.034626687287371, 0.0348157452188014, 
0.0350078524717065, 0.0352030914601802, 0.0354015477433469, 0.0356033101811652, 
0.0358084710997623, 0.0360171264669954, 0.0362293760789949, 0.036445323758512, 
0.0366650775659613, 0.03688875002413, 0.0371164583576123, 0.0373483247481212, 
0.0375844766069372, 0.0378250468658688, 0.0380701742882299, 0.0383200038014792, 
0.0385746868533296, 0.0388343817933054, 0.0390992542819271, 0.0393694777299149, 
0.039645233770049, 0.0399267127645933, 0.0402141143514924, 0.0405076480328902, 
0.040807533809899, 0.0411140028679745, 0.0414272983177305, 0.0417476759965708, 
0.0420754053371236, 0.0424107703091546, 0.0427540704424168, 0.0431056219387807, 
0.0434657588829993, 0.0438348345626068, 0.0442132229087647, 0.044601320071367, 
0.0449995461434327, 0.0454083470517938, 0.0458281966333537, 0.0462595989188234, 
0.0467030906488711, 0.0471592440511516, 0.0476286699107725, 0.0481120209715376, 
0.0486099957108927, 0.0491233425380589, 0.0496528644725487, 0.0501994243693676, 
0.0507639507679851, 0.0513474444549734, 0.051950985845493, 0.0525757433070947, 
0.0532229825712918, 0.0538940774048775, 0.0545905217450995, 0.0553139435419255, 
0.056066120598458, 0.0568489987593387, 0.057664712869572, 0.0585156110163421, 
0.0594042826789734, 0.0603335915536144, 0.0613067139980275, 0.0623271842694416, 
0.0633989480201066, 0.0645264258918732, 0.0657145895414403, 0.0669690530715999, 
0.0682961836964944, 0.0697032366094175, 0.0711985205630849, 0.0727916027787821, 
0.0744935647142573, 0.0763173243023653, 0.0782780460729794, 0.0803936689398167, 
0.0826855937122238, 0.0851795907383465, 0.0879070160575547, 0.0909064680490198, 
0.094226086264293, 0.0979268086855492, 0.102087097943432, 0.106809988595619, 
0.112233933328991, 0.118550128711142, 0.126031447513301, 0.135083429931383, 
0.146340382425665, 0.16086271045264, 0.18059115607419, 0.209574921863875, 
0.258226243010845, 0.366514667499264))
,  equalTo( expected ) ) 
 

