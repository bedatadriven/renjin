library(hamcrest)

 
 
expected <- c(146.73099882522+0i, 9.0413198916421+0i, 3.90348445624946+0i, 
3.07672985004356-0i, 2.18018737874067+0i, 1.90415104916343-0i, 
1.53391458734433-0i, 1.39466298138099-0i, 1.19167427823787+0i, 
1.10715228827184-0i, 0.978531442420657-0i, 9.21511247001708e-01-8e-16i, 
0.832488477213697+0i, 0.791295278144314-0i, 0.725894094217964-0i, 
0.694671397891808-0i, 0.644512319850991-0i, 0.619991076536025-0i, 
0.58025052983925-0i, 0.560458505392618-0i, 0.528160756236337-0i, 
0.511835522385036-0i, 0.485043656187949-0i, 0.471338537793996-0i, 
0.44873666975906-0i, 0.437061984644207-0i, 0.417724311072503-0i, 
0.407656359173893-0i, 0.390912261621294-0i, 0.382138525032313-0i, 
0.367490105841405-0i, 0.359774870285072-0i, 0.346844570395494-0i, 
0.34000659405362-0i, 0.328502812521692-0i, 0.32240037992989-0i, 
0.312094261595426-0i, 0.30661491685579-0i, 0.2973242886983-0i, 
0.292377620327278-0i, 0.283955630647013-0i, 0.279468097683999-0i, 
0.271795024765184-0i, 0.2677061793551-0i, 0.260683422644517-0i, 
0.256943107364923-0i, 0.250488710766493-0i, 0.247054948722825-0i, 
0.241100218259205-0i, 0.237937603639681-0i, 0.232424519187785-0i, 
0.229502974748235-0i, 0.22438218625845+0i, 0.221675993495608+0i, 
0.216905253086429-0i, 0.214392287587447-0i, 0.209935210616086+0i, 
0.207596333553934+0i, 0.203421410739766-0i, 0.201239980455858-0i, 
0.197319783557263+0i, 0.195281260401915+0i, 0.191591798535259+0i, 
0.189683422787261+0i, 0.186203617025974+0i, 0.184414144562365-0i, 
0.181125396170633-0i, 0.179444880132272-0i, 0.176330713492595+0i, 
0.174750322853472-0i, 0.171796088407448-0i, 0.170307956357457-0i, 
0.167500582089366+0i, 0.166097678658885+0i, 0.163425461093243-0i, 
0.162101485609342-0i, 0.159553913164465+0i, 0.158303203024705+0i, 
0.155870806010185-0i, 0.154688258955443-0i, 0.152362481626326+0i, 
0.151243489238902-0i, 0.149016580200845-0i, 0.147956970782487+0i, 
0.145821888737614+0i, 0.144817878061914+0i, 0.142768210436492-0i, 
0.141816359140948-0i, 0.139846251577189+0i, 0.138943428177073-0i, 
0.137047523224398-0i, 0.136190871905397-0i, 0.134364255532939+0i, 
0.133551168020769-0i, 0.131789322804526-0i, 0.131017413724248-0i, 
0.129316177752269+0i, 0.128583262983132-0i, 0.126938793678569-0i, 
0.126242871284873-0i, 0.124651613476942-0i, 0.123990846855424-0i, 
0.122449504539376-0i, 0.121822207468402-0i, 0.120327718792866-0i, 
0.119732342098871-0i, 0.118281857210909-0i, 0.117716976777343-0i, 
0.116307838253739-0i, 0.115772144075414-0i, 0.11440186979512-0i, 
0.113894155696778-0i, 0.112560424215948-0i, 0.112079577628769+0i, 
0.110780216534014-0i, 0.110325207148441-0i, 0.109058185853019-0i, 
0.108628050391423+0i, 0.107391481589176-0i, 0.106985297110897-0i, 
0.105777460123495-0i, 0.105394280690433-0i, 0.104213716568796-0i, 
0.103852365882751-0i, 0.102698297918295-0i, 0.102356333866084-0i, 
0.101231650036272-0i, 0.100893277109037-0i, 0.0999409806584879+0i, 
0.100893277109037-0i, 0.101231650036271-0i, 0.102356333866084+0i, 
0.102698297918295+0i, 0.103852365882751-0i, 0.104213716568796-0i, 
0.105394280690433-0i, 0.105777460123495+0i, 0.106985297110897-0i, 
0.107391481589176-0i, 0.108628050391423-0i, 0.109058185853019+0i, 
0.110325207148441+0i, 0.110780216534014+0i, 0.112079577628769+0i, 
0.112560424215948+0i, 0.113894155696778-0i, 0.11440186979512+0i, 
0.115772144075414+0i, 0.116307838253739+0i, 0.117716976777343-0i, 
0.11828185721091+0i, 0.119732342098871-0i, 0.120327718792866+0i, 
0.121822207468402-0i, 0.122449504539376-0i, 0.123990846855424-0i, 
0.124651613476942+0i, 0.126242871284873+0i, 0.12693879367857-0i, 
0.128583262983132+0i, 0.129316177752269+0i, 0.131017413724248+0i, 
0.131789322804526+0i, 0.133551168020769+0i, 0.13436425553294+0i, 
0.136190871905397+0i, 0.137047523224398+0i, 0.138943428177073+0i, 
0.139846251577189+0i, 0.141816359140948+0i, 0.142768210436492+0i, 
0.144817878061914+0i, 0.145821888737614+0i, 0.147956970782487-0i, 
0.149016580200845+0i, 0.151243489238902-0i, 0.152362481626326+0i, 
0.154688258955444+0i, 0.155870806010185+0i, 0.158303203024706+0i, 
0.159553913164465+0i, 0.162101485609342+0i, 0.163425461093243+0i, 
0.166097678658885+0i, 0.167500582089367+0i, 0.170307956357457+0i, 
0.171796088407448+0i, 0.174750322853472+0i, 0.176330713492595+0i, 
0.179444880132272+0i, 0.181125396170633+0i, 1.84414144562365e-01+1e-15i, 
0.186203617025974+0i, 0.189683422787261-0i, 0.191591798535259+0i, 
0.195281260401915+0i, 0.197319783557263+0i, 0.201239980455858+0i, 
0.203421410739766+0i, 0.207596333553934+0i, 0.209935210616086+0i, 
0.214392287587447+0i, 0.216905253086429+0i, 0.221675993495608+0i, 
0.22438218625845+0i, 0.229502974748235+0i, 0.232424519187785+0i, 
0.237937603639681-0i, 0.241100218259205+0i, 0.247054948722825+0i, 
0.250488710766493+0i, 0.256943107364923+0i, 0.260683422644517+0i, 
0.2677061793551+0i, 0.271795024765184+0i, 0.279468097683999+0i, 
0.283955630647013+0i, 0.292377620327278+0i, 0.2973242886983+0i, 
0.30661491685579+0i, 0.312094261595426+0i, 0.32240037992989+0i, 
0.328502812521692+0i, 0.34000659405362+0i, 0.346844570395494+0i, 
0.359774870285072-0i, 0.367490105841405+0i, 0.382138525032314+0i, 
0.390912261621294-0i, 0.407656359173893+0i, 0.417724311072503+0i, 
0.437061984644208+0i, 0.44873666975906-0i, 0.471338537793997+0i, 
0.48504365618795+0i, 0.511835522385035+0i, 0.528160756236337-0i, 
0.560458505392618+0i, 0.58025052983925+0i, 0.619991076536025+0i, 
0.644512319850991-0i, 0.69467139789181+0i, 0.725894094217965+0i, 
7.91295278144314e-01+8e-16i, 0.832488477213697-0i, 0.921511247001708+0i, 
0.978531442420657+0i, 1.10715228827184+0i, 1.19167427823787-0i, 
1.39466298138099+0i, 1.53391458734433+0i, 1.90415104916343+0i, 
2.18018737874067-0i, 3.07672985004357+0i, 3.90348445624947+0i, 
9.0413198916421+0i) 


assertThat(stats:::fft(z=c(1, 0.844777877533877, 0.779836500488062, 0.751776083816205, 
0.728972046476971, 0.713782634329407, 0.700286483537697, 0.69000410188183, 
0.680528732755927, 0.672811720357511, 0.665558816117345, 0.65941034677322, 
0.653560162174428, 0.648466132479701, 0.643578465939694, 0.639240018930667, 
0.635052030361154, 0.631280519626745, 0.627623103093015, 0.62429204273985, 
0.62105018389579, 0.618070756360705, 0.615162792797604, 0.612470309928299, 
0.609836236052316, 0.607382166226026, 0.604976636929855, 0.602723665143859, 
0.600511605310058, 0.598430441894421, 0.596384179956987, 0.594451425549251, 
0.592548758708821, 0.590745432782927, 0.588968283418965, 0.587278783849985, 
0.585612243290432, 0.584023594125817, 0.582455227357592, 0.580956524218062, 
0.579475854700904, 0.578057848745627, 0.576655970229713, 0.575310751208722, 
0.573980030837151, 0.572700782261367, 0.571434630415209, 0.570215438053979, 
0.569008127752993, 0.567843828134234, 0.566690351748778, 0.565576411059821, 
0.564472365473654, 0.56340478184207, 0.562346275562825, 0.561321499514913, 
0.560305076896643, 0.559319946091249, 0.558342525030207, 0.557394210307529, 
0.556453030642604, 0.555538991118714, 0.554631571608519, 0.553749517059202, 
0.552873619284618, 0.552021478446867, 0.551175076346521, 0.550350970057462, 
0.549532224076043, 0.548734442391918, 0.547941677430052, 0.547168660039778, 
0.54640034655558, 0.545650665937044, 0.544905403675264, 0.544177750547219, 
0.543454254470627, 0.54274742517572, 0.542044513251448, 0.541357398771523, 
0.540673981327218, 0.540005557684563, 0.53934062809896, 0.538689947939393, 
0.538042574472026, 0.537408759659856, 0.536778078257088, 0.536160313339809, 
0.535545521280854, 0.53494304770413, 0.534343397972373, 0.533755508944552, 
0.533170305227321, 0.532596341148127, 0.532024933382788, 0.531464277763617, 
0.530906058160101, 0.530358133973994, 0.529812533454047, 0.5292767998623, 
0.5287432848643, 0.528219234274153, 0.527697303879476, 0.527184459293601, 
0.526673642636595, 0.526171555260435, 0.525671409189155, 0.525179656266664, 
0.524689763225868, 0.524207946078058, 0.523727912189676, 0.523255654433647, 
0.522785107753084, 0.522322053682025, 0.521860642611368, 0.521406455718432, 
0.520953847559979, 0.520508209191006, 0.520064088826516, 0.51962669694838, 
0.519190765631204, 0.518761333704113, 0.518333307952851, 0.517911563896268, 
0.517491174479912, 0.51707685972297, 0.51666385072863, 0.516256719336883, 
0.515850847312187, 0.516256719336883, 0.51666385072863, 0.51707685972297, 
0.517491174479912, 0.517911563896268, 0.518333307952851, 0.518761333704113, 
0.519190765631204, 0.51962669694838, 0.520064088826516, 0.520508209191006, 
0.520953847559979, 0.521406455718432, 0.521860642611368, 0.522322053682025, 
0.522785107753084, 0.523255654433647, 0.523727912189676, 0.524207946078058, 
0.524689763225868, 0.525179656266664, 0.525671409189155, 0.526171555260435, 
0.526673642636595, 0.527184459293601, 0.527697303879476, 0.528219234274153, 
0.5287432848643, 0.5292767998623, 0.529812533454047, 0.530358133973994, 
0.530906058160101, 0.531464277763617, 0.532024933382788, 0.532596341148127, 
0.533170305227321, 0.533755508944552, 0.534343397972373, 0.53494304770413, 
0.535545521280854, 0.536160313339809, 0.536778078257088, 0.537408759659856, 
0.538042574472026, 0.538689947939393, 0.53934062809896, 0.540005557684563, 
0.540673981327218, 0.541357398771523, 0.542044513251448, 0.54274742517572, 
0.543454254470627, 0.544177750547219, 0.544905403675264, 0.545650665937044, 
0.54640034655558, 0.547168660039778, 0.547941677430052, 0.548734442391918, 
0.549532224076043, 0.550350970057462, 0.551175076346521, 0.552021478446867, 
0.552873619284618, 0.553749517059202, 0.554631571608519, 0.555538991118714, 
0.556453030642604, 0.557394210307529, 0.558342525030207, 0.559319946091249, 
0.560305076896643, 0.561321499514913, 0.562346275562825, 0.56340478184207, 
0.564472365473654, 0.565576411059821, 0.566690351748778, 0.567843828134234, 
0.569008127752993, 0.570215438053979, 0.571434630415209, 0.572700782261367, 
0.573980030837151, 0.575310751208722, 0.576655970229713, 0.578057848745627, 
0.579475854700904, 0.580956524218062, 0.582455227357592, 0.584023594125817, 
0.585612243290432, 0.587278783849985, 0.588968283418965, 0.590745432782927, 
0.592548758708821, 0.594451425549251, 0.596384179956987, 0.598430441894421, 
0.600511605310058, 0.602723665143859, 0.604976636929855, 0.607382166226026, 
0.609836236052316, 0.612470309928299, 0.615162792797604, 0.618070756360705, 
0.62105018389579, 0.62429204273985, 0.627623103093015, 0.631280519626745, 
0.635052030361154, 0.639240018930667, 0.643578465939694, 0.648466132479701, 
0.653560162174428, 0.65941034677322, 0.665558816117345, 0.672811720357511, 
0.680528732755927, 0.69000410188183, 0.700286483537697, 0.713782634329407, 
0.728972046476971, 0.751776083816205, 0.779836500488062, 0.844777877533877
))
,  equalTo( expected ) ) 
 

